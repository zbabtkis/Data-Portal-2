//
// jQuery Scrollable Plugin 
// http://github.com/rehandalal/jquery-scrollable
// Version: 1.0.1
// 
// Create iOS / Mac OS X Lion style fading scrollbars for scrollable elements.
// 
// Copyright (c) 2012, Rehan Dalal
// Licensed under the Unlicense (http://unlicense.org/)
//
(function(a){"use strict";var b={create:function(b){return this.each(function(){function k(){e.show_track&&h.fadeOut(e.fade_out_time,function(){a.browser.msie&&this.style.removeAttribute("filter")}),i.fadeOut(e.fade_out_time,function(){a.browser.msie&&this.style.removeAttribute("filter")})}function l(a){var b,d,f;return b=a.originalEvent,d=b.wheelDelta?-b.wheelDelta:b.detail,d/=Math.abs(d),f=c.scrollTop()+d*e.mousewheel_step,c.scrollTop(f),i.css({top:e.margin+c.scrollTop()/(e._scrollableHeight-e._containerHeight)*(h.height()-i.height())+"px"}),c.scrollTop()<=0||c.scrollTop()>=e._scrollableHeight-e._containerHeight}function m(){e._scrollableHeight>e._containerHeight&&(e.show_track&&h.fadeIn(e.fade_in_time,function(){a.browser.msie&&this.style.removeAttribute("filter")}),i.fadeIn(e.fade_in_time,function(){a.browser.msie&&this.style.removeAttribute("filter")}))}var c,d,e,f,g,h,i,j;d={align:"right",fade:!0,fade_in_time:150,fade_out_time:500,margin:0,mousewheel:!0,mousewheel_step:32,show_track:!1,thumb_class:"scrollable_thumb",track_class:"scrollable_track",track_width:8,wrapper_class:"scrollable_wrapper"},c=a(this),e=a.extend(d,b),c.scrollable("destroy"),c.data("scrollable",e),e._containerHeight=c.height(),f=a("<div></div>").addClass(e.wrapper_class).css({height:e._containerHeight,overflow:"hidden",position:"relative",width:c.outerWidth()}),c.wrap(f),g=c.parent(),h=a("<div></div>").addClass(e.track_class).css({bottom:e.margin+"px",display:!e.fade&&e.show_track?"block":"none",left:e.align==="left"?e.margin+"px":"auto",position:"absolute",right:e.align==="right"?e.margin+"px":"auto",top:e.margin+"px",width:e.track_width+"px",zIndex:1e3}),i=a("<div></div>").addClass(e.thumb_class).css({display:e.fade?"none":"block",left:e.align==="left"?e.margin+"px":"auto",position:"absolute",right:e.align==="right"?e.margin+"px":"auto",top:e.margin+"px",width:e.track_width+"px",zIndex:2e3}),e._track=h,e._thumb=i,c.scrollable("refresh"),j=h.clone().css({display:"block",visibility:"hidden",zIndex:0}),g.append(j).append(h).append(i),i.draggable({axis:"y",containment:j,start:function(){a(this).data("dragging",!0)},stop:function(){a(this).data("dragging",!1),g.data("hovering")!==!0&&e.fade===!0&&k()},drag:function(){var b=(a(this).position().top-e.margin)/(h.height()-i.height())*(e._scrollableHeight-e._containerHeight);c.scrollTop(b)}}),e.fade===!0&&g.hover(function(){g.data("hovering",!0),m()},function(){g.data("hovering",!1),i.data("dragging")!==!0&&k()}),e.mousewheel===!0&&(g.on("DOMMouseScroll",l),g.on("mousewheel",l))})},destroy:function(){return this.each(function(){var b,c;b=a(this),c=b.data("scrollable"),c!==undefined&&(b.css({height:"",maxHeight:"",position:"",overflow:""}),b.parent().children().each(function(){a(this)[0]!==b[0]&&a(this).remove()}),b.unwrap(),a(window).unbind(".scrollable"),b.removeData("scrollable"))})},refresh:function(){return this.each(function(){var b,c,d,e;b=a(this),c=b.data("scrollable");if(c!==undefined){d=b.scrollTop(),b.css({height:"auto",maxHeight:"none",overflow:"visible"}),c._scrollableHeight=b.height(),b.css({height:"",maxHeight:"",overflow:"hidden"}),b.parent().css({height:b.height()}),c._containerHeight=b.height(),b.scrollTop(d),e=c._containerHeight*c._containerHeight/c._scrollableHeight,e<16&&(e=16),c._thumb.css({height:e+"px"}),c._thumb.css({top:c.margin+b.scrollTop()/(c._scrollableHeight-c._containerHeight)*(c._track.height()-c._thumb.height())+"px"});if(c._scrollableHeight<=c._containerHeight)c._track.hide(),c._thumb.hide();else if(c.fade!==!0||b.parent().data("hovering")===!0)c.show_track&&c._track.show(),c._thumb.show()}})}};a.fn.scrollable=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.create.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.scrollable")}})(jQuery)